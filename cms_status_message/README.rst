==================
CMS status message
==================

.. 
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! This file is generated by oca-gen-addon-readme !!
   !! changes will be overwritten.                   !!
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
   !! source digest: sha256:23b64dca13113b3c325390396d7cb418805a8aebfdee8d815d7e70d5cc63c693
   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

.. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png
    :target: https://odoo-community.org/page/development-status
    :alt: Beta
.. |badge2| image:: https://img.shields.io/badge/licence-LGPL--3-blue.png
    :target: http://www.gnu.org/licenses/lgpl-3.0-standalone.html
    :alt: License: LGPL-3
.. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fwebsite--cms-lightgray.png?logo=github
    :target: https://github.com/OCA/website-cms/tree/13.0/cms_status_message
    :alt: OCA/website-cms
.. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png
    :target: https://translation.odoo-community.org/projects/website-cms-13-0/website-cms-13-0-cms_status_message
    :alt: Translate me on Weblate
.. |badge5| image:: https://img.shields.io/badge/runboat-Try%20me-875A7B.png
    :target: https://runboat.odoo-community.org/builds?repo=OCA/website-cms&target_branch=13.0
    :alt: Try me on Runboat

|badge1| |badge2| |badge3| |badge4| |badge5|

A "status message" is an important message that you want to show to
users.

For instance: a user submit a form or does a specific action and you
want to report the status of this action like "your profile has been
updated" or "Your upgrade has been successful.".

This module allows to easily display this kind of messages to your
users.

Messages are displayed using Twitter bootstrap alerts.

You can add several messages: they will be displayed one after another.

**Table of contents**

.. contents::
   :local:

Usage
=====

Python code
~~~~~~~~~~~

Set a message:

.. code:: python

    msg = _('My important message.')
    if request.website:
        request.website.add_status_message(msg)

By default the message type is ``info``. The title (the label at the
beginning of the message) matches the message type:

-  'info': 'Info'
-  'success': 'Success'
-  'danger': 'Error'
-  'warning': 'Warning'

You can change message parameters:

.. code:: python

    msg = _('Watch out!')
    if request.website:
        request.website.add_status_message(msg, type_='warning', title='Oh no')

Messages will be displayed like this:

.. image:: https://raw.githubusercontent.com/OCA/website-cms/13.0/cms_status_message/images/preview.png

Autodismiss
~~~~~~~~~~~

By default messages will be auto-dismissed after 8 seconds.
You can turn this off by setting an ir.config_param like::

    cms_status_message.autodismiss = 0

You can customize the timeout by setting the key::

    cms_status_message.autodismiss_timeout = 3000  # milliseconds


You can also customize this on demand when you create the message:


.. code:: python

    msg = _('I will disappear more slowly')
    options = {'autodismissTimeout': 10000}
    if request.website:
        request.website.add_status_message(msg, dismiss_options=options)


Javascript code
~~~~~~~~~~~~~~~

Dependencies:

.. code:: javascript


    var msg_tool = require('cms_status_message.tool');
    var core = require('web.core');
    var _t = core._t;

Inject a custom message on the fly:

.. code:: javascript

    msg = {
        'msg': _t('Item unpublished.'),
        'title': _t('Warning'),
        'type': 'warning'
    }
    msg_tool.render_messages(msg).then(function(html) {
        // wipe existing
        $('.status_message').remove();
        // inject new
        $(html).hide().prependTo('#wrap').fadeIn('slow');
    });


Add a status message to the session, useful if you want to show the
message only after a redirect:

.. code:: javascript

    var msg =  _t('Contratulations! You made it!.');
    var options = {'title': _('My title'), 'dismissible': false};
    msg_tool.add_message(msg, options);

Customize appereance
~~~~~~~~~~~~~~~~~~~~

By default the alert box is added on top of ``<main />`` content. If you
want to customize this behavior just override or disable
``cms_status_message.add_status_message`` template.


Test your theme look and feel
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Go to `/cms/status-message/display-test` to see how messages will look like
when your theme is applied.

Known issues / Roadmap
======================

Get rid of `website` dependency and move features to a standalone model.

Changelog
=========

13.0.1.0.1 (2021-08-23)
**Features**

- Migration to v13 (`#111 <https://github.com/OCA/website-cms/issues/111>`_)


11.0.1.3.0 (2018-08-07)
~~~~~~~~~~~~~~~~~~~~~~~

**Improvements**

* Get rid of example package

  The example package was there only to show how a message would look like.
  But in real life you want always to verify how they look like
  with your theme styles applied.

  Now we have a new route `/cms/status-message/display-test` to check them.
  `cms_status_message_example` module has been removed.


11.0.1.2.0 (2018-08-07)
~~~~~~~~~~~~~~~~~~~~~~~

**Improvements**

* Add auto-dimiss option

  By default messages will be auto-dismissed after 8 seconds.
  You can turn this off by setting an ir.config_param like::

    cms_status_message.autodismiss = 0

  You can customize the timeout by setting the key::

    cms_status_message.autodismiss_timeout = 3000  # milliseconds

  Check README for further info.


11.0.1.1.0 (2018-04-22)
~~~~~~~~~~~~~~~~~~~~~~~

**Improvements**

* Improve JS API

  1. load qweb template on demand
  2. load qweb template only if not loaded yet
  3. use promises for rendering

  We load qweb templates via JS.
  Prior to this change we got 1 request every time,
  on every page load per each template,
  even if we were not using any status message feature.

  Now we load templates only when needed
  and we load them only if not loaded yet,
  lowering page load time a bit :)

  Plus, rendering now returns a promise object so you can chain calls
  and do things when rendering is really finished.


11.0.1.0.0 (2018-01-18)
~~~~~~~~~~~~~~~~~~~~~~~

Upgrade to v11

Bug Tracker
===========

Bugs are tracked on `GitHub Issues <https://github.com/OCA/website-cms/issues>`_.
In case of trouble, please check there if your issue has already been reported.
If you spotted it first, help us to smash it by providing a detailed and welcomed
`feedback <https://github.com/OCA/website-cms/issues/new?body=module:%20cms_status_message%0Aversion:%2013.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.

Do not contact contributors directly about support or help with technical issues.

Credits
=======

Authors
~~~~~~~

* Camptocamp

Contributors
~~~~~~~~~~~~

* Simone Orsi <simone.orsi@camptocamp.com>

Maintainers
~~~~~~~~~~~

This module is maintained by the OCA.

.. image:: https://odoo-community.org/logo.png
   :alt: Odoo Community Association
   :target: https://odoo-community.org

OCA, or the Odoo Community Association, is a nonprofit organization whose
mission is to support the collaborative development of Odoo features and
promote its widespread use.

This module is part of the `OCA/website-cms <https://github.com/OCA/website-cms/tree/13.0/cms_status_message>`_ project on GitHub.

You are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.
